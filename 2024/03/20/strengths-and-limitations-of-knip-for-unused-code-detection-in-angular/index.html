<!DOCTYPE html><html lang="en"><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>Strengths and Limitations of Knip for Unused Code Detection in Angular</title><meta property="og:title" content="Strengths and Limitations of Knip for Unused Code Detection in Angular" /><meta property="og:site_name" content="Iterative Engineering Blog" /><meta name="author" content="Iterative Engineering Team" /><meta property="og:locale" content="en_GB" /><meta property="og:description" content="Knip tool&#39;s ability to find unused code in the Angular codebase" /><meta name="description" content="Knip tool&#39;s ability to find unused code in the Angular codebase" /><meta property="og:url" content="https://blog.iterative.engineering/2024/03/20/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/" /><meta property="og:image" content="https://blog.iterative.engineering/assets/images/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/main.webp" /><meta name="twitter:url" content="https://blog.iterative.engineering/2024/03/20/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/" /><meta name="twitter:card" content="summary" /><meta name="twitter:title" content="Strengths and Limitations of Knip for Unused Code Detection in Angular | Iterative Engineering Blog" /><meta name="twitter:site" content="Iterative Engineering Blog" /><meta name="twitter:description" content="Knip tool&#39;s ability to find unused code in the Angular codebase" /><link rel="canonical" href="https://iterative.engineering" /><link rel="shortcut icon" href="/assets/images/favicon.png" /><link rel="stylesheet" href="/assets/css/app.min.css?68b77fc765da08f8b1409d0b1c20c22f" /><link rel="alternate" type="application/rss+xml" title="Iterative Engineering Blog" href="/feed.xml" /><link rel="canonical" href="/2024/03/20/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/" /> <script defer type="text/javascript" src="https://widget.clutch.co/static/js/widget.js" ></script> <script defer type="text/javascript" src="/assets/js/main.js?68b77fc765da08f8b1409d0b1c20c22f" ></script> <script async type="fs-cc" fs-cc-categories="analytics" src="https://www.googletagmanager.com/gtag/js?id=UA-68442502-1" ></script> <script type="fs-cc" fs-cc-categories="analytics"> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-68442502-1'); </script> <script type="fs-cc" fs-cc-categories="analytics"> (function () { window.ldfdr = window.ldfdr || {}; (function (d, s, ss, fs) { fs = d.getElementsByTagName(s)[0]; function ce(src) { var cs = d.createElement(s); cs.src = src; setTimeout(function () { fs.parentNode.insertBefore(cs, fs) }, 1); } ce(ss); })(document, 'script', 'https://sc.lfeeder.com/lftracker_v1_lYNOR8xMKOG7WQJZ.js'); })(); </script> <script type="fs-cc" fs-cc-categories="analytics"> (function (c, l, a, r, i, t, y) { c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) }; t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i; y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y); })(window, document, "clarity", "script", "4g6s96579b"); </script> <script> function toggleClass() { const mobileMenu = document.querySelector(".mobile_menu-container"); mobileMenu.classList.toggle("toggleMenu"); const hambBcg = document.querySelector(".hamburger"); hambBcg.classList.toggle("hamburger_changeBcg"); } </script></head><body id="strengths-and-limitations-of-knip-for-unused-code-detection-in-angular" class="post-layout" ><header class="header"><div class="container"><nav class="navbar"> <a href="/" class="logo_wrapper-1920-xx"> <img src="/assets/images/nav/logo-without-blog.svg" alt="logo" /> </a> <a href="/" class="logo_wrapper"> <img src="/assets/images/nav/logo-all.svg" alt="logo" /> </a><ul class="menu"><li> <a href="/category/business">Business</a></li><li> <a href="/category/technical">Technical</a></li><li> <a href="/category/lifestyle">Lifestyle</a></li><li> <a id="homepage_btn" style=" background-color: rgb(95, 103, 170); padding: 0 32px; color: white; border: 0; font-family: 'Alexandria'; " href="https://iterative.engineering" >Go to the main page</a ></li></ul><div onclick="toggleClass()" class="hamburger"> <span class="hamb_bar"></span></div></nav><div class="mobile_menu-container"><ul class="menu_mobile"><li><a href="/category/business">Business</a></li><li><a href="/category/technical">Technical</a></li><li><a href="/category/lifestyle">Lifestyle</a></li><li> <a style=" text-decoration: underline; font-weight: bold; font-family: 'Alexandria'; " href="https://iterative.engineering" >Go to the main page</a ></li></ul></div></div></header><main><div class="post_container"><article class="post"><section class="post_header-wrapper"><div class="image-wrapper"><figure class="absolute-bg" style="background-image: url('/assets/images/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/main.webp');" ></figure></div><div class="post-details"><h1>Strengths and Limitations of Knip for Unused Code Detection in Angular</h1><div class="title-separator"></div><div class="author-wrapper"> <img class="author-img" src="/assets/images/team/ml.webp" alt="Marcin Licznerski from Iterative Engineering" /><div class="author-bio"> <time class="post-date" datetime="2024-03-20T00:00:00-05:00" itemprop="datePublished" >20.03.2024 </time> <span class="author-name"> Marcin Licznerski</span> <span> Senior Software Engineer @ Iterative Engineering </span></div></div><div class="tag-container"> <span> <a class="tag primary-tag hide-on-mobile" href="/category/technical" >technical</a > </span><div class="secondary-tags"> <a class="tag primary-tag show-on-mobile" href="/category/technical" >technical</a > <a class="tag" href="/tag/angular" title="Angular" >#Angular</a > <a class="tag" href="/tag/knip" title="Knip" >#Knip</a > <a class="tag" href="/tag/unused-code-detection" title="Unused Code Detection" >#Unused Code Detection</a > <a class="tag" href="/tag/frontend" title="Frontend" >#Frontend</a > <a class="tag" href="/tag/javascript" title="JavaScript" >#JavaScript</a > <a class="tag" href="/tag/typescript" title="TypeScript" >#TypeScript</a > <a class="tag" href="/tag/tools" title="Tools" >#Tools</a ></div></div></div></section><section><div class="content"><p>As the codebase grows and evolves, the cost of maintaining it becomes higher. In extreme cases, leading to situations where upkeep takes significantly more time and effort than new developments. While you cannot prevent balancing out of those proportions overtime, there are ways to mitigate the risk of ending up in an endless maintenance loop. One of such is identification and removal of unused or overhead code to decrease complexity.</p><p>This article will delve into the capabilities of Knip tool that identifies unused code in Angular based applications. It advertises itself as a tool that “finds unused files, dependencies and exports in your JavaScript and TypeScript projects. Less code and dependencies lead to improved performance, less maintenance and easier refactorings”. Gaining popularity in the JavaScript ecosystem based on <a href="https://www.npmjs.com/package/knip">NPM weekly downloads</a>.</p><p>To fully understand Knip’s effectiveness, we will comprehensively evaluate it in real-world application. In the upcoming section, we will evaluate its performance in identifying unused code in the Adscore project, which we are developing and maintaining at Iterative. Additionally, we will analyze Knip’s ability to navigate complex code within a sandbox Angular project in a controlled environment. This two-pronged approach will check Knip’s versatility and provide insights into its capabilities in Angular codebases.</p><h1 id="real-world-project">Real world project</h1><p><a href="https://adscore.com/">Adscore</a> allows users to categorize web traffic into distinct buckets like organic, paid, bot-generated, and low-quality. The app acts as a shield for ad budgets. The detailed comprehension guarantees that resources are directed towards the intended audience - real users - thereby maximizing campaign efficiency and return on investment.</p><h2 id="projects-statistics">Projects Statistics</h2><p>The following statistics provide an idea of the size of the Adscore system.</p><table><thead><tr><th>Language</th><th>Files</th><th>Lines of code</th></tr></thead><tbody><tr><td>TypeScript</td><td>248</td><td>26995</td></tr><tr><td>SCSS</td><td>112</td><td>16535</td></tr><tr><td>HTML</td><td>78</td><td>12822</td></tr></tbody></table><p>The total count of Components, Pipes, and Directives is 74.</p><h2 id="ignore-file">Ignore File</h2><p>After several iterations due to Knip incorrectly detecting in-use packages, following ignore file was created:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
 <span class="dl">"</span><span class="s2">angular</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">config</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">angular.json</span><span class="dl">"</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="dl">"</span><span class="s2">ignore</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="c1">// both files used in angular.json file</span>
    <span class="dl">"</span><span class="s2">Karma.conf.js</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">src/polyfills.ts</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">],</span>
  <span class="dl">"</span><span class="s2">ignoreDependencies</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="c1">// used in angular.json</span>
    <span class="dl">"</span><span class="s2">@angular-eslint/schematics</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">@angular-eslint/template-parser</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">eslint-config-prettier</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">jasmine-core</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">Karma-chrome-launcher</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// used by Karma, several more plugins enlisted but removed for brevity</span>
    <span class="c1">// imported in global styles.scss, Knip lacks Sass plugin at the time of writing</span>
    <span class="dl">"</span><span class="s2">loaders.css</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">husky</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// used in package.json</span>
    <span class="dl">"</span><span class="s2">pretty-quick</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// used by husky</span>
    <span class="dl">"</span><span class="s2">simple-line-icons</span><span class="dl">"</span> <span class="c1">// used in custom script</span>
  <span class="p">],</span>
<span class="p">}</span>
</code></pre></div></div><p>Some dependencies are used in the <code class="language-plaintext highlighter-rouge">angular.json</code> file, some in <code class="language-plaintext highlighter-rouge">.sass</code> files. This is something that can be improved in the plugins used by Knip.</p><h2 id="knip-scan-results-summary">Knip Scan Results Summary</h2><p>Knip created following report after creation of ignore file (Knip provides list of unused components for each section, those details are removed for brevity):</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Unused files (11)
Unused dependencies (3)
Unused devDependencies (5)
Unused exports (10)
Unused exported types (1)
Configuration issues (1)
</code></pre></div></div><p>In total, Knip allowed us to detect and remove 435 lines of code (which is 1.61% of total LOC) and 16 files.</p><p>While integrating Knip with our Angular project, optimizing the knip.jsonc file required multiple iterations to ensure accurate detection of unused code. However, this configuration effort was a one-time investment; moving forward, we can seamlessly integrate Knip into our post-refactoring workflow for recurring analysis. While inclusion in the automated pipeline is pending further evaluation, Knip has already proven its potential as a valuable tool for our codebase optimization. Despite Knip’s detection capabilities, we identified additional unused assets that require further investigation. We’ll be exploring this scenario within a controlled sandbox environment to gain deeper insights.</p><h1 id="sandbox-project">Sandbox Project</h1><p>A project containing unused code has been prepared. The objective is to identify all unused cases, which are:</p><ol><li>7 class properties</li><li>10 class methods</li><li>2 interface properties</li><li>2 variables</li><li>1 constant</li><li>5 classes (Angular’s: Component, Directive, Module, Pipe, Service)</li><li>1 dependency (<code class="language-plaintext highlighter-rouge">@angular/forms</code> - installed by default but unused in the project, and <code class="language-plaintext highlighter-rouge">express</code>)</li><li>1 devDependency (<code class="language-plaintext highlighter-rouge">express</code>)</li><li>1 unused export (variable used locally)</li><li>2 NgRx Actions (functions)</li><li>1 NgRx Effect (class)</li><li>2 functions - one is unit tested</li><li>1 asset</li></ol><p>Total: 36</p><p>Code is available at: <a href="https://github.com/IterativeEngineering/blog.angular-knip-unused-code-article">https://github.com/IterativeEngineering/blog.angular-knip-unused-code-article</a></p><h2 id="intentional-challenges">Intentional Challenges</h2><p>Some of the parts of the code are directly unused, which should be easy to detect by the tool. Some are trickier like for example: an interface has a property, then the object implementing the interface, has the property defined, but property itself is unused as in the following snippet:</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">InUseFeatureState</span> <span class="p">{</span>
  <span class="nl">definedButUnusedState</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">initialState</span><span class="p">:</span> <span class="nx">InUseFeatureState</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">definedButUnusedState</span><span class="p">:</span> <span class="dl">'</span><span class="s1">unused</span><span class="dl">'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div><p>Ideally, an unused interface property should be detected on a first run. But iteratively also will do the job:</p><ol><li>Run the tool</li><li>Identify and remove the detected code</li><li>Run the tool again</li><li>Repeat until no more unused code is detected</li></ol><h2 id="analyzing-knip-results">Analyzing Knip Results</h2><p>Tested with following versions:</p><ul><li>Angular - v17.0.5</li><li>Knip - v5.0.0</li></ul><p>Command used:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx knip <span class="nt">--include</span> classMembers
</code></pre></div></div><p>Since Knip version 4, class members are <a href="https://knip.dev/blog/knip-v4#unused-class-members">opted out by default</a>, but given Angular’s heavy class usage, enabling it seemed beneficial.</p><p>Result of the first Knip scan (details of each section removed for brevity):</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Unused files (6)
Unused dependencies (3)
Unused devDependencies (8)
Unlisted binaries (2)
Unused exports (4)
Unused exported class members (16)
</code></pre></div></div><p>Let’s review each section’s outcome individually.</p><h2 id="unused-files">Unused files</h2><table><thead><tr><th style="text-align: left">No</th><th style="text-align: left">File</th><th style="text-align: left">Detection</th><th style="text-align: left">Remarks</th></tr></thead><tbody><tr><td style="text-align: left">1</td><td style="text-align: left">unused-function.ts</td><td style="text-align: left">Correct</td><td style="text-align: left">Even when in barrel file (index.ts) Knip was able to detect this file correctly.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">unused.service.ts</td><td style="text-align: left">Correct</td><td style="text-align: left">Service is exported but it is unused</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">unused-type.ts</td><td style="text-align: left">Correct</td><td style="text-align: left">Types are exported but not used anywhere in the code</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">unused.util.ts</td><td style="text-align: left">Correct</td><td style="text-align: left">Util is exported but not used anywhere in the code</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">unused-feature.module.ts</td><td style="text-align: left">Correct</td><td style="text-align: left">Module is exported but not used anywhere in the cod</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">.eslintrc.js</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Used by ES Lint</td></tr></tbody></table><p>Detected: 5 files of 6 were detected correctly.</p><h2 id="unused-dependencies">Unused dependencies</h2><table><thead><tr><th style="text-align: left">No</th><th style="text-align: left">Dependency</th><th style="text-align: left">Detection</th><th style="text-align: left">Remarks</th></tr></thead><tbody><tr><td style="text-align: left">1</td><td style="text-align: left">@angular/compiler</td><td style="text-align: left">Correct</td><td style="text-align: left">Not directly used in the project, but for example @angular-devkit/build-angular depends on it, so it will be installed anyway in package-lock.json</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">@angular/forms</td><td style="text-align: left">Correct</td><td style="text-align: left">Forms are installed by Angular by default, but this test project does not use them.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">@angular/platform-browser-dynamic</td><td style="text-align: left">Correct</td><td style="text-align: left">Not directly used in the project but other Angular liblaries depends on it, will be installed anyway in package-lock.json</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">unused.util.ts</td><td style="text-align: left">Correct</td><td style="text-align: left">Util is exported but not used anywhere in the code</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">unused-feature.module.ts</td><td style="text-align: left">Correct</td><td style="text-align: left">Module is exported but not used anywhere in the code</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">.eslintrc.js</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Used by ES Lint</td></tr></tbody></table><p>Detected: 1 of 1 – 2 other dependencies have been detected as unused, but are used by Angular, won’t be included in the final score.</p><h2 id="unused-devdependencies">Unused devDependencies</h2><table><thead><tr><th style="text-align: left">No</th><th style="text-align: left">Dependency</th><th style="text-align: left">Detection</th><th style="text-align: left">Remarks</th></tr></thead><tbody><tr><td style="text-align: left">1</td><td style="text-align: left">express</td><td style="text-align: left">Correct</td><td style="text-align: left">Unused in the project</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">husky</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Used in package.json</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">jasmine-core</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Installed by Angular and used during testing, but can be removed because it will be installed as a sub-dependency</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">karma-chrome-launcher</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Installed by Angular, cannot run tests without it</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">karma-coverage</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Can be used by Karma to generate coverage report, installed by default by Angular</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">karma-jasmine</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Used by Karma</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">karma-jasmine-html-reporter</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Used by Karma</td></tr><tr><td style="text-align: left">8</td><td style="text-align: left">lint-staged</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Used by Husky</td></tr></tbody></table><p>Detected: 1 of 1 - All detected but with false positives.</p><h2 id="unlisted-binaries">Unlisted binaries</h2><table><thead><tr><th style="text-align: left">No</th><th style="text-align: left">Binary</th><th style="text-align: left">Detection</th><th style="text-align: left">Remarks</th></tr></thead><tbody><tr><td style="text-align: left">1</td><td style="text-align: left">eslint</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Listed as script in package.json and run by lint-staged</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">prettier</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Listed in lint-staged script</td></tr></tbody></table><p>Detected: 0 of 0 - Did not expect to find any binaries, as the code was not prepared for this case. Anyway all were false positives.</p><h2 id="unused-exports">Unused exports</h2><table><thead><tr><th style="text-align: left">No</th><th style="text-align: left">Export</th><th style="text-align: left">File</th><th style="text-align: left">Detection</th><th style="text-align: left">Remarks</th></tr></thead><tbody><tr><td style="text-align: left">1</td><td style="text-align: left">UNUSED_CONSTANT</td><td style="text-align: left">constants.ts</td><td style="text-align: left">Correct</td><td style="text-align: left">Constant is exported but unused</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">unusedAction1</td><td style="text-align: left">in-use-feature.actions.ts</td><td style="text-align: left">Correct</td><td style="text-align: left">Action is exported but unused</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">unusedSelector1</td><td style="text-align: left">in-use-feature.selectors.ts</td><td style="text-align: left">Correct</td><td style="text-align: left">Selector is exported but unused</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">rootState</td><td style="text-align: left">in-use-feature.selectors.ts</td><td style="text-align: left">Correct</td><td style="text-align: left">Selector is exported but only used locally</td></tr></tbody></table><p>Detected: 4 of 4 - Found one expected export and 3 unused Actions and Selectors.</p><h2 id="unused-exported-class-members">Unused exported class members</h2><p>The biggest part of the Knip result, and most likely the biggest part of any Angular application.</p><table><thead><tr><th style="text-align: left">No</th><th style="text-align: left">Class Member</th><th style="text-align: left">File</th><th style="text-align: left">Detection</th><th style="text-align: left">Remarks</th></tr></thead><tbody><tr><td style="text-align: left">1</td><td style="text-align: left">unusedEffect$</td><td style="text-align: left">InUseFeatureEffects</td><td style="text-align: left">Correct</td><td style="text-align: left"> </td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">unusedEmitAction</td><td style="text-align: left">InUseFeatureStateFacade</td><td style="text-align: left">Correct</td><td style="text-align: left"> </td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">unusedProperty</td><td style="text-align: left">InUseFeatureStateFacade</td><td style="text-align: left">Correct</td><td style="text-align: left"> </td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">unusedProperty</td><td style="text-align: left">InUseComponent</td><td style="text-align: left">Correct</td><td style="text-align: left"> </td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">unusedMethod</td><td style="text-align: left">InUseFeatureStateFacade</td><td style="text-align: left">Correct</td><td style="text-align: left"> </td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">unusedPublicMethod</td><td style="text-align: left">InUseComponent</td><td style="text-align: left">Correct</td><td style="text-align: left"> </td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">unusedProperty</td><td style="text-align: left">UnusedComponent</td><td style="text-align: left">Correct</td><td style="text-align: left"> </td></tr><tr><td style="text-align: left">8</td><td style="text-align: left">inUseMethod</td><td style="text-align: left">UnusedComponent</td><td style="text-align: left">Correct</td><td style="text-align: left">Partially correct, because component is unused, but this variable is used in HTML (which was not recognized)</td></tr><tr><td style="text-align: left">9</td><td style="text-align: left">unusedPublicMethod</td><td style="text-align: left">UnusedComponent</td><td style="text-align: left">Correct</td><td style="text-align: left"> </td></tr><tr><td style="text-align: left">10</td><td style="text-align: left">inUseProperty</td><td style="text-align: left">UnusedComponent</td><td style="text-align: left">Correct</td><td style="text-align: left">Partially correct, because component is unused, but this variable is used in HTML (which was not recognized)</td></tr><tr><td style="text-align: left">11</td><td style="text-align: left">unusedMethod</td><td style="text-align: left">InUseService</td><td style="text-align: left">Correct</td><td style="text-align: left"> </td></tr><tr><td style="text-align: left">12</td><td style="text-align: left">inUseMethod</td><td style="text-align: left">AppComponent</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Used in HTML file</td></tr><tr><td style="text-align: left">13</td><td style="text-align: left">inUseAction1Effect$</td><td style="text-align: left">InUseFeatureEffects</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Used by NgRx</td></tr><tr><td style="text-align: left">14</td><td style="text-align: left">inUseProperty</td><td style="text-align: left">InUseComponent</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Used in HTML file</td></tr><tr><td style="text-align: left">15</td><td style="text-align: left">inUseStoreProperty$</td><td style="text-align: left">InUseComponent</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Used in HTML file</td></tr><tr><td style="text-align: left">16</td><td style="text-align: left">inUseMethod</td><td style="text-align: left">InUseComponent</td><td style="text-align: left">Incorrect</td><td style="text-align: left">Used in HTML file</td></tr></tbody></table><p>Detected: 11 of 17</p><h2 id="summary-of-first-run">Summary of first run</h2><p>In its initial run, Knip successfully identified 22 out of 36 cases, demonstrating a promising detection rate. However, it’s important to note that 14 of the findings were classified as false positives, highlighting the need for further refinement.</p><p>Code removed after the first run can be found in <code class="language-plaintext highlighter-rouge">clean-up-after-knip-v5-detection</code> branch.</p><h2 id="subsequent-launches">Subsequent launches</h2><p>Knip’s second run yielded an additional 2 detections:</p><ol><li>inUseActionInUnusedEffect</li><li>unusedSelector2</li></ol><p>Total identified cases: 24 out of 36. Subsequent launches did not detect any additional code.</p><h2 id="missed-parts">Missed Parts</h2><p>Let’s check which scenarios were not detected:</p><ol><li>UnusedPipe - most probably not found due to being defined in Angular Module which is in use</li><li>UnusedPath - same as above</li><li>UnusedComponent - same as above</li><li>UnusedDirective - same as above</li><li>unusedUtilButTestedFunction - function is unused, but unit tested - most probably because Knip does not have (unlike Jest) plugin for Jasmine it recognized this function as in use</li><li>unusedPrivateProperty - Haven’t been detected, but ESLint or IDE’s like Visual Studio Code are capable to mark this case as unused</li><li>unusedPrivateProperty2 - same as above</li><li>unusedPrivateMethod - same as above</li><li>definedButUnusedState - same as above</li><li>unusedState - same as above</li><li>unused.svg - looks like assets files were not checked at all</li></ol><h1 id="a-summary-of-knips-efficiency-with-angular">A Summary of Knip’s Efficiency with Angular</h1><p>Understanding Knip’s capabilities and limitations is crucial for leveraging its power in Angular. Let’s explore its current performance, areas for improvement, and practical tips to optimize your code analysis process.</p><p>Strengths:</p><ul><li>Detects unused functions and exports efficiently</li><li>Can help reduce code complexity and improve maintainability</li></ul><p>Weaknesses:</p><ul><li>May require multiple iterations for complex projects</li><li>In the context of Angular:<ul><li>Cannot find unused Components, Pipes etc if defined in Module because, and currently does not analyze HTML templates</li><li>Can detect unused Actions/Selectors (NgRx) but not Effects/Reducers</li><li>Detects class properties used in HTML templates as unused</li><li>Doesn’t fully support Angular’s default test framework (Jasmine)</li><li>May misinterpret certain devDependencies as unused</li><li>Dependencies used only in Sass files are falsely detected as unused</li><li>Assets are not checked</li></ul></li><li>Package.json scripts: limited detection in scripts, it didn’t detect <code class="language-plaintext highlighter-rouge">Husky</code> and <code class="language-plaintext highlighter-rouge">lint-staged</code></li><li>Unit testing: May not detect unused code if tested with unsupported test frameworks</li></ul><p>Tips for Efficient Usage:</p><ul><li>Review and remove unused Angular’s router paths before running Knip to improve Module detection.</li><li>Consider alternative test frameworks supported by Knip for broader detection - Since Angular 16, <a href="https://blog.angular.io/moving-angular-cli-to-jest-and-web-test-runner-ef85ef69ceca">Jest has experimental support</a></li><li>Be aware of limitations specific to your technology stack and adjust workflow accordingly.</li></ul><p>Additional Notes:</p><ul><li>Knip’s Angular support is evolving, so future updates might address some limitations</li><li>Explore alternative code analysis tools that might complement Knip and address its shortcomings</li></ul></div><div class="table-content"><div class="share-with-friends"> <span>Share with friends:</span><ul class="post__social"><li><a href="https://www.facebook.com/sharer/sharer.php?u=https://blog.iterative.engineering/2024/03/20/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/" target="_blank"><i class="fa fa-facebook"></i></a></li><li><a href="https://twitter.com/intent/tweet?&text=Strengths and Limitations of Knip for Unused Code Detection in Angular+https://blog.iterative.engineering/2024/03/20/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/+by+Marcin Licznerski" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?mini=true&source=Strengths and Limitations of Knip for Unused Code Detection in Angular&summary=Knip tool's ability to find unused code in the Angular codebase&url=https://blog.iterative.engineering/2024/03/20/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/" target="_blank"><i class="fa fa-linkedin"></i></a></li><li><a href="https://www.reddit.com/submit?url=https://blog.iterative.engineering/2024/03/20/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/" target="_blank"><i class="fa fa-reddit-alien"></i></a></li></ul></div><div class="content-header">CONTENTS:</div><div id="intro-link"> <a href="#strengths-and-limitations-of-knip-for-unused-code-detection-in-angular">Strengths and Limitations of Knip for Unused Code Detection in Angular</a></div><div><div id="table-of-contents" class="toc"><ul id="toc" class="section-nav"><li class="toc-entry toc-h1"><a href="#real-world-project">Real world project</a><ul><li class="toc-entry toc-h2"><a href="#projects-statistics">Projects Statistics</a></li><li class="toc-entry toc-h2"><a href="#ignore-file">Ignore File</a></li><li class="toc-entry toc-h2"><a href="#knip-scan-results-summary">Knip Scan Results Summary</a></li></ul></li><li class="toc-entry toc-h1"><a href="#sandbox-project">Sandbox Project</a><ul><li class="toc-entry toc-h2"><a href="#intentional-challenges">Intentional Challenges</a></li><li class="toc-entry toc-h2"><a href="#analyzing-knip-results">Analyzing Knip Results</a></li><li class="toc-entry toc-h2"><a href="#unused-files">Unused files</a></li><li class="toc-entry toc-h2"><a href="#unused-dependencies">Unused dependencies</a></li><li class="toc-entry toc-h2"><a href="#unused-devdependencies">Unused devDependencies</a></li><li class="toc-entry toc-h2"><a href="#unlisted-binaries">Unlisted binaries</a></li><li class="toc-entry toc-h2"><a href="#unused-exports">Unused exports</a></li><li class="toc-entry toc-h2"><a href="#unused-exported-class-members">Unused exported class members</a></li><li class="toc-entry toc-h2"><a href="#summary-of-first-run">Summary of first run</a></li><li class="toc-entry toc-h2"><a href="#subsequent-launches">Subsequent launches</a></li><li class="toc-entry toc-h2"><a href="#missed-parts">Missed Parts</a></li></ul></li><li class="toc-entry toc-h1"><a href="#a-summary-of-knips-efficiency-with-angular">A Summary of Knip’s Efficiency with Angular</a></li></ul></div></div></div></section><section class="sharing-section"><div class="author-wrapper-mobile"> <img class="author-img" src="/assets/images/team/ml.webp" alt="Marcin Licznerski from Iterative Engineering" /><div class="author-bio"> <time class="post-date" datetime="2024-03-20T00:00:00-05:00" itemprop="datePublished" >20.03.2024 </time> <span class="author-name"> Marcin Licznerski</span> <span> Senior Software Engineer @ Iterative Engineering </span></div></div><div class="share-with-friends share-with-friends-two"> <span>Share with friends:</span><ul class="post__social"><li><a href="https://www.facebook.com/sharer/sharer.php?u=https://blog.iterative.engineering/2024/03/20/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/" target="_blank"><i class="fa fa-facebook"></i></a></li><li><a href="https://twitter.com/intent/tweet?&text=Strengths and Limitations of Knip for Unused Code Detection in Angular+https://blog.iterative.engineering/2024/03/20/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/+by+Marcin Licznerski" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?mini=true&source=Strengths and Limitations of Knip for Unused Code Detection in Angular&summary=Knip tool's ability to find unused code in the Angular codebase&url=https://blog.iterative.engineering/2024/03/20/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/" target="_blank"><i class="fa fa-linkedin"></i></a></li><li><a href="https://www.reddit.com/submit?url=https://blog.iterative.engineering/2024/03/20/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/" target="_blank"><i class="fa fa-reddit-alien"></i></a></li></ul></div></section></article><section class="related_posts-container"><div class="related-posts"><h2 style="margin-top:0px;padding-top:calc(var(--spacing--A)/ 4);">Related</h2><div class="related-posts-separator"></div><div class="posts-items"> <a class="posts__link" href="/2024/04/29/secure-vps-with-cloud-flare-zero-trust-in-5min/" itemprop="url" ><div class="related_post-item"> <span class="related_post-item-tag">technical</span> <img class="related_post-img" src="/assets/images/secure-vps-with-cloud-flare-zero-trust-in-5min/zero-trust-network-image.webp" alt="Secure VPS with CloudFlare Zero Trust in 5min" data-aos="fade-in" itemprop="image" /><div class="related_post-aligner"><h4 className="related_post-title">Secure VPS with CloudFlare Zero Trust in 5min</h4><p class="related_post-content"> You've probably heard about the **xz backdoor**, which has unsettled admins all around the world, and you likely still remember Log4Shell - another CVE10 that sent shockwaves through IT security teams a few years back....</p><div class="related_post-separator"></div><div class="related_author-wrapper"> <img class="author-img" src="/assets/images/team/lh.webp" alt="Łukasz Hyła from Iterative Engineering" /><div class="author-bio"> <time class="post-date" datetime="2024-04-29T00:00:00-05:00" itemprop="datePublished" >29.04.2024 </time> <span class="author-name"> Łukasz Hyła</span> <span class="author-details"> Senior Software Engineer @ Iterative Engineering </span></div></div></div></div></a> <a class="posts__link" href="/2022/08/22/battling-ad-fraud-spoofed-browsers-detection/" itemprop="url" ><div class="related_post-item"> <span class="related_post-item-tag">technical</span> <img class="related_post-img" src="/assets/images/battling-ad-fraud-spoofed-browsers-detection/battling-ad-fraud-spoofed-browsers-detection.webp" alt="Battling Ad Fraud - Spoofed Browsers Detection" data-aos="fade-in" itemprop="image" /><div class="related_post-aligner"><h4 className="related_post-title">Battling Ad Fraud - Spoofed Browsers Detection</h4><p class="related_post-content"> $68bn worldwide of total ad spend will fall victim to fraudsters in 2022 alone. So what is AdTech doing to fight off fraud and what kind of technical challenges is it facing? Detecting if ad...</p><div class="related_post-separator"></div><div class="related_author-wrapper"> <img class="author-img" src="/assets/images/team/kg.webp" alt="Krzysztof Gąsior from Iterative Engineering" /><div class="author-bio"> <time class="post-date" datetime="2022-08-22T00:00:00-05:00" itemprop="datePublished" >22.08.2022 </time> <span class="author-name"> Krzysztof Gąsior</span> <span class="author-details"> CEO @ Iterative Engineering </span></div></div></div></div></a> <a class="posts__link" href="/2022/08/08/contract-testing-with-spring/" itemprop="url" ><div class="related_post-item"> <span class="related_post-item-tag">technical</span> <img class="related_post-img" src="/assets/images/contract-testing-with-spring/contract-testing-with-spring.webp" alt="Contract testing with Spring" data-aos="fade-in" itemprop="image" /><div class="related_post-aligner"><h4 className="related_post-title">Contract testing with Spring</h4><p class="related_post-content"> Efficient distributed software testing, in particular microservices, is a very challenging subject, yet essential to success. Therefore, as programmers, we often confront a task: how to effectively simulate the behavior of an external service? As...</p><div class="related_post-separator"></div><div class="related_author-wrapper"> <img class="author-img" src="/assets/images/icons/person-multiple-icon.svg" alt="Multiple Authors" /><div class="author-bio"> <time class="post-date" datetime="2022-08-08T00:00:00-05:00" itemprop="datePublished" >8.08.2022 </time> <span class="author-name">2 Authors</span></div></div></div></div></a></div></div></section></div></main><footer class="footer_container"><div class="main_content-wrapper"><div class="main_content"><div class="column-left"><div class="headquarter"><h4 class="headers">HEADQUARTERS</h4><div class="address text_line-spacing"> <img class="column_left-icon" src="/assets/images/icons/location-pin-icon.svg" alt="location" /><div class="location"> <span>&nbsp;ul. Wolności 191/311</span> <span>&nbsp;41-800 Zabrze, Silesia, Poland</span></div></div><div class="text_line-spacing"> <img class="column_left-icon" src="/assets/images/icons/mail-icon.svg" alt="email" /> <a class="text-hover" href="mailto:office@iterative.pl" >office@iterative.pl</a ></div></div><div class="business-development"><h4 class="headers">BUSINESS DEVELOPMENT</h4><div class="text_line-spacing"> <img class="column_left-icon" src="/assets/images/icons/person-icon.svg" alt="email" /> <span>Krzysztof Gąsior</span></div><div> <img class="column_left-icon" src="/assets/images/icons/phone-icon.svg" alt="email" /> <a class="text_line-spacing text-hover" href="tel:+48793901086" >+48 793 901 086</a ></div><div class="contact-meeting"> <img class="column_left-icon" src="/assets/images/icons/mail-icon.svg" alt="email" /> <a class="text_line-spacing text-hover" href="mailto:krzysztof.gasior@iterative.pl" >krzysztof.gasior@iterative.pl</a > <a class="link_schedule-meeting" href="https://calendly.com/krzysztof-gasior/" target="_blank" > <button class="schedule-meeting">Schedule a meeting</button> </a></div></div><div class="clutch-widget" data-url="https://widget.clutch.co" data-widget-type="2" data-height="45" data-theme="white" data-clutchcompany-id="746552" ></div></div><div class="separator"></div><div class="right-column"><div><h4 class="headers">FIND OUT WHAT WE WRITE ABOUT</h4><a class="text_line-spacing text-hover" href="/2024/09/12/iterative-engineering-new-address/" >Iterative Engineering changes its address</a ><br /> <a class="text_line-spacing text-hover" href="/2024/07/12/iterative-delivers-innovative-solution-for-biomethane/" >Iterative Engineering delivers AI solution for biomethane plant development</a ><br /> <a class="text_line-spacing text-hover" href="/2024/04/29/secure-vps-with-cloud-flare-zero-trust-in-5min/" >Secure VPS with CloudFlare Zero Trust in 5min</a ><br /> <a class="text_line-spacing text-hover" href="/2024/03/20/strengths-and-limitations-of-knip-for-unused-code-detection-in-angular/" >Strengths and Limitations of Knip for Unused Code Detection in Angular</a ><br /> <a class="text_line-spacing text-hover" href="/2024/01/14/teaching-java-reflections-on-the-attempt/" >Teaching Java: Reflections on the Attempt</a ><br /></div><div class="discover-offer"><h4 class="headers">DISCOVER OUR OFFER</h4><a class="text_line-spacing text-hover" href="https://iterative.engineering/software-development-for-london-based-companies" >Software Development for London Based Companies</a ><br /> <a class="text_line-spacing text-hover" href="https://iterative.engineering/software-development-for-aberdeen-based-companies" >Software Development for Aberdeen Based Companies</a ><br /> <a class="text_line-spacing text-hover" href="https://iterative.engineering/digital-product-development-for-fintech" >Digital Product Development for Fintech</a ><br /></div><div class="menu_footer"><h4 class="headers">Menu</h4><a class="text_line-spacing text-hover" href="https://iterative.engineering/" >Home</a ><br /> <a class="text_line-spacing text-hover" href="https://iterative.engineering/about.html" >About us</a ><br /> <a class="text_line-spacing text-hover" href="https://iterative.engineering/services.html" >Services</a ><br /> <a class="text_line-spacing text-hover" href="/" style="color: #e1e3e4; font-weight: 700" >Blog</a ></div></div></div></div><div class="bottom_bar-container"><div class="bottom_bar-policy-social"><div class="bottom_bar-policy-info"><div class="company-info"><div class="bottom_bar-copyrights"> <img class="bottom_bar-copyright-icon" src="/assets/images/icons/copyright.svg" alt="copyright" /> <span class="bottom_bar-text bottom_bar-rights_text"> 2024 Iterative Engineering Sp. z o.o. - All rights reserved </span></div><span class="bottom_bar-text" >VAT-EU: PL6482804153 | REGON: 388898977 | KRS: 0000900004 </span></div><div class="policy_container"> <a class="bottom_bar-text" href="/cookies-policy.html" target="_blank" rel="noopener noreferrer nofollow" >Cookies policy</a > <a class="bottom_bar-text" href="https://iterative.engineering/privacy-policy.html" target="_blank" rel="noopener noreferrer nofollow" >Privacy policy</a ></div></div><div class="bottom_bar-social-icons"> <a href="https://clutch.co/profile/iterative-engineering#summary" target="_blank" rel="noopener noreferrer nofollow" > <img class="social-icons" src="/assets/images/icons/clutch-icon.svg" alt="clutch profile" /> </a> <a href="https://github.com/IterativeEngineering" target="_blank" rel="noopener noreferrer nofollow" > <img class="social-icons" src="/assets/images/icons/github-icon.svg" alt="github profile" /> </a> <a href="https://www.facebook.com/IterativeEngineering/" target="_blank" rel="noopener noreferrer nofollow" > <img class="social-icons" src="/assets/images/icons/fb-icon.svg" alt="facebook profile" /> </a> <a href="https://linkedin.com/company/11263564/" target="_blank" rel="noopener noreferrer nofollow" > <img class="social-icons" src="/assets/images/icons/linkedin-icon.svg" alt="linkedin profile" /> </a></div></div></div></footer><script src="/assets/js/app.min.js?68b77fc765da08f8b1409d0b1c20c22f"></script><div class="cookies-container cookies"><div fs-cc="banner" class="fs-cc-banner_component"><div class="fs-cc-banner_container"><div class="fs-cc-banner_text"> By clicking <strong style="color: var(--primary-font-color)">“Accept”</strong>, you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. View our <a href="/cookies-policy.html" target="_blank" rel="noopener noreferrer nofollow" class="fs-cc-banner_text-link" >Privacy Policy</a > for more information.</div><div class="fs-cc-banner_buttons-wrapper"> <a fs-cc="open-preferences" href="#!" class="fs-cc-banner_text-link" tabindex="0" >Preferences</a ><div class="buttons-prefs-container"> <a fs-cc="deny" href="#!" class="fs-cc-banner_button fs-cc-button-alt w-button" tabindex="0" >Deny</a > <a fs-cc="allow" href="#!" class="fs-cc-banner_button w-button confirm-cookies" tabindex="0" >Accept</a ></div><div fs-cc="close" class="fs-cc-banner_close" tabindex="0"><div class="fs-cc-banner_close-icon"> <svg fill="currentColor" aria-hidden="true" focusable="false" viewBox="0 0 16 16" ><path d="M9.414 8l4.293-4.293-1.414-1.414L8 6.586 3.707 2.293 2.293 3.707 6.586 8l-4.293 4.293 1.414 1.414L8 9.414l4.293 4.293 1.414-1.414L9.414 8z" ></path> </svg></div></div></div></div></div></div><div fs-cc-scroll="disable" fs-cc="preferences" class="fs-cc-prefs_component-2 w-form" style="display: none" > <form id="cookie-preferences" class="fs-cc-prefs_form" aria-label="Cookie Preferences" ><div fs-cc="close" class="fs-cc-prefs_close" role="button" tabindex="0"><div class="fs-cc-prefs_close-icon-2 w-embed"> <svg fill="currentColor" aria-hidden="true" focusable="false" viewBox="0 0 16 16" ><path d="M9.414 8l4.293-4.293-1.414-1.414L8 6.586 3.707 2.293 2.293 3.707 6.586 8l-4.293 4.293 1.414 1.414L8 9.414l4.293 4.293 1.414-1.414L9.414 8z" ></path> </svg></div></div><div class="fs-cc-prefs_content"><div class="fs-cc-prefs_space-small"><div class="fs-cc-prefs_title">Privacy Preference Center</div></div><div class="fs-cc-prefs_space-small"><div class="fs-cc-prefs_text"> When you visit websites, they may store or retrieve data in your browser. This storage is often necessary for the basic functionality of the website. The storage may be used for marketing, analytics, and personalization of the site, such as storing your preferences. Privacy is important to us, so you have the option of disabling certain types of storage that may not be necessary for the basic functioning of the website. Blocking categories may impact your experience on the website.</div></div><div class="fs-cc-prefs_space-medium"> <a fs-cc="deny" href="#!" class="fs-cc-prefs_button fs-cc-button-alt w-button" role="button" tabindex="0" >Reject all cookies</a > <a fs-cc="allow" href="#!" class="fs-cc-prefs_button w-button" role="button" tabindex="0" >Allow all cookies</a ></div><div class="fs-cc-prefs_space-small"><div class="fs-cc-prefs_title"> Manage Consent Preferences by Category</div></div><div class="fs-cc-prefs_option _1st"><div class="fs-cc-prefs_toggle-wrapper"><div class="fs-cc-prefs_label">Essential</div><div class="fs-cc-prefs_text"><strong>Always Active</strong></div></div><div class="fs-cc-prefs_text"> These items are required to enable basic website functionality.</div></div><div class="fs-cc-prefs_option"><div class="fs-cc-prefs_toggle-wrapper"><div class="fs-cc-prefs_label">Analytics</div><label style="position: relative"> <input type="checkbox" fs-cc-checkbox="analytics" class="fs-cc-prefs_checkbox" /><div class="fs-cc-prefs_checkbox-field"><div class="fs-cc-prefs_toggle"></div></div></label></div><div class="fs-cc-prefs_text"> These items help the website operator understand how its website performs, how visitors interact with the site, and whether there may be technical issues. This storage type usually doesn’t collect information that identifies a visitor.</div></div><div class="fs-cc-prefs_buttons-wrapper"> <a fs-cc="submit" href="#!" class="fs-cc-prefs_button w-button" role="button" tabindex="0" >Confirm my preferences and close</a ></div></div></form><div fs-cc="close" class="fs-cc-prefs_overlay"></div></div><script async src="https://cdn.jsdelivr.net/npm/@finsweet/cookie-consent@1/fs-cc.js" ></script></body></html>
  